scale_x_log10(breaks = c(1, 10, 50))+
scale_y_log10()+
ggtitle('Total_SO2 Versus Free_S02')+
xlab("Log Free Sulphur Dioxide") +
ylab("Log Total Sulphur Dioxide")+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_log10(breaks = c(1, 10, 100, 200))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = c(1, 10, 100, 200))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10))+
xlim = c(0,200)
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = 200)
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = c(0,200)
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = c(0,200))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = c(0,180))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = c(0,180))+
scale_y_continuous(limits = c(0,60))
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_jitter(alpha = 0.7, size = 1) +
geom_smooth( se = TRUE, size = 1)+
scale_x_log10(breaks = c(1, 10, 50))+
scale_y_log10(limits = c(log10(0.5),log10(4)) )+
ggtitle('Total_SO2 Versus Free_S02')+
xlab("Log Free Sulphur Dioxide") +
ylab("Log Total Sulphur Dioxide")+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour = quality)) +
geom_jitter(alpha = 0.7, size = 1) +
geom_smooth( se = TRUE, size = 1)+
scale_x_log10(breaks = c(1, 10, 50))+
scale_y_log10()+
ggtitle('Total_SO2 Versus Free_S02')+
xlab("Log Free Sulphur Dioxide") +
ylab("Log Total Sulphur Dioxide")+
scale_color_brewer()+
theme_dark()
ggscatmat(redwine) + theme_grey(base_size=5)
ggcorr(redwine,
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-70,size =3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.3,angle =-45,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-45,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-30,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 5,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 7,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 8,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 6,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='Figs/',
echo=FALSE, warning=FALSE, message=FALSE)
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(markdown)
library(ggplot2)
library(GGally)
library(gridExtra)
library(knitr)
# 加载数据
redwine <- read.csv("wineQualityReds.csv")
dim(redwine)
summary(redwine)
summary(redwine$quality)
ggplot(data = redwine, aes(x=factor(quality)))+
geom_bar()
summary(redwine$alcohol)
ggplot(data=redwine, aes(x=alcohol)) +
geom_histogram(binwidth = .1)+
scale_x_continuous(limits = c(8, 16), breaks = seq(0, 20, 1))
summary(redwine$residual.sugar)
ggplot(data=redwine, aes(x=residual.sugar)) +
geom_histogram(binwidth = .5)+
scale_x_continuous(limits = c(0, 16), breaks = seq(0, 20, 1))
summary(redwine$pH)
ggplot(data=redwine, aes(x=pH)) +
geom_histogram(binwidth = .1)+
scale_x_continuous(limits = c(2.5, 4.5), breaks = seq(0, 5, 0.5))
summary(redwine$citric.acid)
ggplot(data=redwine, aes(x=citric.acid)) +
geom_histogram(binwidth = .01)+
scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.1))
summary(redwine$volatile.acidity)
ggplot(data=redwine, aes(x=volatile.acidity)) +
geom_histogram(binwidth = .05)+
scale_x_continuous(limits = c(0, 1.6), breaks = seq(0, 2, 0.1))
summary(redwine$fixed.acidity)
ggplot(data=redwine, aes(x=fixed.acidity)) +
geom_histogram(binwidth = .1)+
scale_x_continuous(limits = c(4, 16), breaks = seq(0, 20, 1))
summary(redwine$density)
ggplot(data=redwine, aes(x=density)) +
geom_histogram(binwidth = .001)
summary(redwine$sulphates)
ggplot(data=redwine, aes(x=sulphates)) +
geom_histogram(binwidth = .05)
summary(redwine$total.sulfur.dioxide)
ggplot(data=redwine, aes(x=total.sulfur.dioxide)) +
geom_histogram(binwidth = 5)
summary(redwine$free.sulfur.dioxide)
ggplot(data=redwine, aes(x=free.sulfur.dioxide)) +
geom_histogram(binwidth = 1)
summary(redwine$chlorides)
ggplot(data=redwine, aes(x=chlorides)) +
geom_histogram(binwidth = .01)
ggpairs(subset(redwine, select = c(-X)),
upper = list(continuous = wrap("cor", size = 2)),
lower = list(continuous = wrap("smooth",size = 0.5, alpha = .1)))
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-90,size =2)
ggscatmat(redwine) + theme_grey(base_size=5)
bp11 <- ggplot(data=redwine, aes(x=factor(quality), y=alcohol))+
geom_boxplot()
bp12 <- ggplot(data=redwine, aes(x=factor(quality), y=volatile.acidity))+
geom_boxplot()
bp13 <- ggplot(data=redwine, aes(x=factor(quality), y=sulphates))+
geom_boxplot()
bp14 <- ggplot(data=redwine, aes(x=factor(quality), y=citric.acid))+
geom_boxplot()
grid.arrange(bp11, bp12, bp13, bp14, ncol = 2, nrow = 2)
ggplot(data = redwine, aes(x = alcohol,y = volatile.acidity, color= actor(quality)))+
geom_point()+
facet_wrap(~quality)+
theme_light()+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(x = alcohol,y = volatile.acidity, color= factor(quality)))+
geom_point()+
facet_wrap(~quality)+
theme_light()+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(y = density, x =  alcohol, color = factor(quality))) +
geom_point(size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
facet_wrap(~quality)+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(y =  sulphates, x = alcohol, colour = factor(quality))) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)  +
scale_y_continuous(limits = c(0.3, 1.5))+
scale_color_brewer()+
theme_dark()
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour =factor( quality))) +
geom_point(alpha = 0.7, size = 1) +
geom_smooth(method = "lm", se = FALSE, size = 1)+
scale_color_brewer()+
theme_dark()+
scale_x_continuous(breaks = seq(0,200,10), limits = c(0,180))+
scale_y_continuous(limits = c(0,60))
p1 <- ggplot(data = redwine, aes(y = alcohol, x = factor(quality)))+
geom_boxplot()+
ggtitle('Alcohol Levels v/s Quality levels')+
xlab('Quality Levels(score between 0 and 10)')+
ylab('Alcohol Levels(% by volume)')
p2 <- ggplot(data = redwine, aes(y = volatile.acidity , x =  factor(quality))) +
geom_boxplot()+
ggtitle('Volatile Acidity Levels v/s Quality levels')+
xlab('Quality Levels(score between 0 and 10)')+
ylab('Volatile Acidity Levels(acetic acid - g / dm^3)')
grid.arrange(p1,p2,ncol=2)
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour =  factor(quality))) +
geom_jitter(alpha = 0.7, size = 1) +
geom_smooth( se = TRUE, size = 1)+
scale_x_log10(breaks = c(1, 10, 50))+
scale_y_log10()+
ggtitle('Total_SO2 Versus Free_S02')+
xlab("Log Free Sulphur Dioxide") +
ylab("Log Total Sulphur Dioxide")+
scale_color_brewer()+
theme_dark()
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=1,angle =-45,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-45,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4
nbreaks = 4,palette = "PuOr",label = TRUE,
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 2
nbreaks = 4,palette = "PuOr",label = TRUE,
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 2
nbreaks = 4,palette = "PuOr",label = TRUE,
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.5)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "PuOr",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "low",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "mid",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = FALSE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = "blue"
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = "grey75"
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = blues9
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = blues9,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = "blues9",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_color = "blue",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 2,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 4,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 8,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
digits = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 3
nbreaks = 4,palette = "high",label = TRUE,
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 3,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
colors = "blue",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = #BBBBBB
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = "#BBBBBB"
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = "#3B9AB2"
name = "spearman correlation coeff",
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = "#3B9AB2",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = "#F21A00",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
mid = "BLUE",
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggcorr(subset(redwine, select = c(-X)),
method = c("all.obs","spearman"),
label_round = 2,
nbreaks = 4,palette = "high",label = TRUE,
label_size = 3,
name = "spearman correlation coeff",
hjust=0.8,angle =-60,size =2.3)
ggplot(aes(y = density, x = alcohol, group = 1),
data = redwine) +
geom_point(alpha = 1/4) +
xlab("Alcohol (% by Volume)") +
ylab("Density (g/cm^3)") +
geom_smooth(method = 'lm') +
ggtitle("Density versus Alcohol Content")
ggplot(data = redwine, aes(y =  free.sulfur.dioxide, x = total.sulfur.dioxide, colour =  factor(quality))) +
geom_jitter(alpha = 0.7, size = 1) +
geom_smooth( se = TRUE, size = 1)+
scale_x_log10(breaks = c(1, 10, 50))+
scale_y_log10()+
ggtitle('Total_SO2 Versus Free_S02')+
xlab("Log Free Sulphur Dioxide (mg / dm^3)") +
ylab("Log Total Sulphur Dioxide (mg / dm^3)")+
scale_color_brewer()+
theme_dark()
